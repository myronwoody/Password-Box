<html lang="en">
  <head>
    <title>overview passwords</title>
    <link rel="stylesheet" media="all" href="./style.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="no-referrer">
    <link rel="shortcut icon" type="image/x-icon" href="https://a.1password.com/app/images/favicon.ico">
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/alertify.min.css"/>
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/alertify.rtl.min.css"/>
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/themes/default.rtl.min.css"/>
  <script>
    delete module.exports
  </script>
  </head>
  <body class="vault-view">
    <div ng-app="myApp" ng-controller="myCtrl">
    <div style="display: none;" class="large-type-popup" id="modal" role="dialog">
      <div class="scroll-box">
        <main class="content-box">
          
        </main>
      </div>
    </div>
    <div id="b5app">
      <div>
        <div id="unlocked-app" aria-hidden="false">
          <header id="top-bar">
            <div id="title-container" class="contains-notifications">
              <a id="main-icon" role="button" aria-label="Home" href="overview.html"><img src="https://a.1password.com/app/images/main-icon.svg" width="46px" height="46px" alt=""></a>
              <div class="menu-wrapper" id="vault-switcher">
                <button class="" aria-haspopup="true" aria-expanded="false" aria-label="Personal vault">
                  <div>
                    <div aria-hidden="true" class="avatar vault small"><img alt="" src="https://a.1password.com/app/images/avatar-vault-default.png"></div>
                    <h1>Personal</h1>
                    <img class="menu-icon" src="https://a.1password.com/app/images/button-chevron.svg" alt="" width="14px" height="32px">
                  </div>
                </button>
                <div class="menu" role="menu" aria-expanded="false" aria-hidden="true" aria-label="Vault Switcher">
                  <div class="vault-list-container" role="presentation">
                    <ul class="section icon" role="presentation">
                      <li>
                        <a role="menuitem" href="/vaults/all">
                          <div aria-hidden="true" class="avatar vault xsmall"><img alt="" src="https://a.1password.com/app/images/all-vaults.png"></div>
                          All Vaults
                        </a>
                      </li>
                    </ul>
                    <ul class="section icon" role="presentation">
                      <li>
                        <a role="menuitem" href="#" class="selected">
                          <div aria-hidden="true" class="avatar vault xsmall"><img alt="" src="https://a.1password.com/app/images/avatar-vault-default.png"></div>
                          Personal
                        </a>
                      </li>
                      <li>
                        <a role="menuitem" href="/vaults/hopkfdbjcjtcru5qvmzcbzi6r4">
                          <div aria-hidden="true" class="avatar vault xsmall"><img alt="" src="https://a.1password.com/app/images/avatar-vault-default.png"></div>
                          {{firstname}}
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div id="global-notice-banner" class="frozen clickable">
                <div role="button"><img src="https://a.1password.com/app/images/frozen-icon.svg" alt="">Default account</div>
              </div>
              <div class="menu-wrapper" id="top-bar-notifications">
                <button class="" disabled="" aria-haspopup="true" aria-expanded="false" aria-label="Notifications, 0">
                  <div>
                    <svg width="32" height="32" class="svg-notifications" xmlns:xlink="http://www.w3.org/1999/xlink">
                      <defs>
                        <mask id="a" width="28" height="23" x="0" y="0" fill="#fff">
                          <path stroke-width="2" d="M19.5 6.7c3.7 1.5 6.4 5 6.4 9.3v3c0 2 1.3 6 4 6H2c3 0 4-4.2 4-6v-3c0-4.2 2.8-8 6.5-9.3V5.5C12.5 3.5 14 2 16 2s3.5 1.6 3.5 3.5v1.2z" stroke="#000" stroke-opacity="0.3"></path>
                        </mask>
                      </defs>
                      <g fill="none" fill-rule="evenodd">
                        <path stroke-width="2" d="M19.5 6.7c3.7 1.5 6.4 5 6.4 9.3v3c0 2 1.3 6 4 6H2c3 0 4-4.2 4-6v-3c0-4.2 2.8-8 6.5-9.3V5.5C12.5 3.5 14 2 16 2s3.5 1.6 3.5 3.5v1.2z" stroke="#000" stroke-opacity="0.3" mask="url(#a)"></path>
                        <path stroke-width="6" d="M20 26c0 2.2-1.8 4-4 4s-4-1.8-4-4h8z" fill="#000" fill-opacity="0.3"></path>
                      </g>
                    </svg>
                    <span>0</span>
                  </div>
                </button>
                <div class="menu" role="menu" aria-expanded="false" aria-hidden="true" aria-label="Notifications">
                  <ul class="empty">You donâ€™t have any notifications currently.</ul>
                </div>
              </div>
            </div>
            <div id="user-menu">
              <div class="menu-container">
                <button class="userLabel" aria-haspopup="true" aria-expanded="true">
                  <div>
                    <div aria-hidden="true" class="avatar default small bg-color-5">{{firstname.charAt(0)}}{{lastname.charAt(0)}}</div>
                    <label class="account-name">{{firstname}} {{lastname}}</label><img class="menu-icon" src="https://a.1password.com/app/images/dropdown-chevron-v2.svg" alt="" width="12px" height="7px">
                  </div>
                </button>
                <div class="active" style="display: none;" role="menu" aria-expanded="true" aria-hidden="false" aria-label="death coderz User Menu">
                  <div><a href="overview.html">My Profile</a><a href="#">Get the Apps</a><a href="#">Import</a><a target="_blank" href="#" rel="noreferrer">Help &amp; Support</a><a id="menu-sign-out"><img src="https://a.1password.com/app/images/padlock.svg" width="13px" height="16px" alt="">Sign Out</a></div>
                </div>
              </div>
            </div>
          </header>
          <nav id="global-sidebar">
            <div id="sidebar-greeting">ðŸŒ‘ Good evening, {{firstname}}.</div>
            <a href="/home">Home</a>
            <div><a href="/billing">Billing</a><a>Invite People...</a></div>
            <div class="bottom-align">
              <div id="sidebar-banner" class="box lavender invite-family" role="link">
                <h4>Invite the Family</h4>
                <p>Share passwords and keep your entire family secure.</p>
                <button aria-label="Dismiss Banner">
                  <svg width="7px" height="7px" class="svg-banner-close" fill-rule="evenodd">
                    <path d="M3.5 2.3L1.3.3C1-.3.8-.3.6 0L.2.7c-.2.2-.2.5 0 .7l2 2.2-2 2.2c-.3.2-.3.5 0 .7l.4.4c.2.2.5.2.7 0l2.2-2 2.2 2c.2.2.5.2.7 0l.4-.4c.2-.2.2-.6 0-.8l-2-2 2-2.3C7 1 7 .8 6.8.6L6.4.2C6.2 0 6 0 5.7.2l-2.2 2z"></path>
                  </svg>
                </button>
              </div>
            </div>
          </nav>
          <section id="vault-content">
            <nav id="sidebar">
              <ul>
                <li id="passwordOverzicht" class="selected"><img src="https://a.1password.com/app/images/sidebar-icons/all.svg" width="18"><span class="name">All Items</span><span class="count count-password">0</span></li>
                <li><img src="https://a.1password.com/app/images/sidebar-icons/favorites.svg" width="18"><span class="name">Favorites</span></li>
                <li><img src="https://a.1password.com/app/images/sidebar-icons/watchtower.svg" width="18"><span class="name">Watchtower</span></li>
                <div class="sidebar-section-header">
                  <h2>Categories</h2>
                  <span>Hide</span>
                </div>
                <li class=""><img src="https://a.1password.com/template/001s.svg" width="20"><span class="name">Logins</span></li>
                <li class=""><img src="https://a.1password.com/template/004s.svg" width="20"><span class="name">Identities</span></li>
                <div class="sidebar-section-header">
                  <h2>Tags</h2>
                  <span>Hide</span>
                </div>
                <li class=""><img src="https://a.1password.com/app/images/sidebar-icons/tags.svg" width="20"><span class="name">Starter Kit</span></li>
                <div class="trash">
                  <li id="trash"><img src="https://a.1password.com/app/images/sidebar-icons/trash.svg" width="18"><span class="name">Trash</span><span class="count">0</span></li>
                </div>
              </ul>
            </nav>
            <div>
              <div id="search"><input type="search" class="short" placeholder="Search" value="" data-com.agilebits.onepassword.user-edited="yes" ></div>
              <div id="item-list">
                  <!-- WHEN LOADED THE DISPLAY SECTIONS WILL BE LOADED HERE -->
              </div>
            </div>
            <section id="item-details" class="">

              <!-- HIER KOMT HET -->
<section class="toolbar"><button class="add">+</button><button class="edit" disabled="">Edit</button><button class="save">Save</button><button class="cancel">Cancel</button><button class="move-to-trash">Move to Trash</button></section>
            </section>
          </section>
          <div class='notifications bottom-right'></div>
        </div>
      </div>
    </div>
  <!--===============================================================================================-->  
    <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
  <!--===============================================================================================-->
    <script src="vendor/bootstrap/js/popper.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <!--===============================================================================================-->
    <script src="vendor/select2/select2.min.js"></script>
  <!--===============================================================================================-->
    <script src="vendor/tilt/tilt.jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="js/main.js"></script>
    <script src="http://cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/alertify.min.js"></script>
    <script type="text/javascript">

var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope) {
    $scope.firstname = localStorage.getItem("firstname");
    $scope.lastname = localStorage.getItem("lastname");
    $scope.country = localStorage.getItem("country");
});

const {clipboard} = require('electron')
var email = localStorage.getItem("email");

function addBackground(obj) {
    document.getElementById(obj.id).style.backgroundColor = "rgba(0, 0, 0, 0.05)"
    // console.log(obj.id);
}

function removeBackground(obj) {
    document.getElementById(obj.id).style.backgroundColor = ""
}


$('#search').on('keyup', function(){
  var inputValue = $(".short").val();
  if(inputValue == ""){
    console.log("clicked");
    $(".searchItem").fadeIn()
  }else{
  // $('imageList div :not(:contains([data*='+ $(this).val() +']))').fadeOut();
  // $('.imageList div').not(':contains("[data*="'+$(this).val()'+" ")').fadeOut();
    $('#item-list li').not('[data*="'+inputValue+'"]').fadeOut()
    $('#item-list li[data*="'+inputValue+'"]').fadeIn();
}
});


function loadSave(obj) {
  $("#item-details").load("https://lmptastytrades.com/api/load-password-content.php?id=" + obj, function() {
      $(".revealButton").click(function() {
          if ($(".revealButton").text() == "Reveal") {
              console.log("true");
              $(".show-password-generator").addClass('reveal')
              $(".revealButton").text('Conceal');
          } else {
              $(".show-password-generator").removeClass('reveal');
              $(".revealButton").text('Reveal');
              console.log("false")
          }
      });
      meterOnLoad($("span #changeIngPassword").text());
  });
  $("#item-details").removeClass('editing ')
  $(".value-container-username").removeAttr('style');
  $(".hideButton").show();
  localStorage.removeItem("oldUsername");
  localStorage.removeItem("oldPassword");
  localStorage.removeItem("oldWebsite");
  localStorage.removeItem("oldNotes");
  localStorage.removeItem("oldTitle");
  $("#item-list").load("https://lmptastytrades.com/api/get-password-list.php?email=" + localStorage.getItem("email"), function() {
      console.log("Done loading password list");
  })
}

function getInfo(obj) {
  localStorage.setItem("clickedPasswordId", obj.id);
  console.log("clicked");
  $("#item-details").load("https://lmptastytrades.com/api/load-password-content.php?id=" + obj.id, function() {
      meterOnLoad($("span #changeIngPassword").text());
      $(".large-type-show").click(function() {
          setTimeout(function() {
              $("#modal").fadeIn();
          }, 100);
      });
  });
}


$(document).on('click', '.cancel-new-password-add', function(){
  $("#item-details").load("https://lmptastytrades.com/api/empty.php");
});


$(document).ready(function() {

  $("#item-list").load("https://lmptastytrades.com/api/get-password-list.php?email=" + localStorage.getItem("email"), function() {
    console.log("Done loading password list");
  })

$(document).on('click', '.revealButton', function() {
      if ($(".revealButton").text() == "Reveal") {
          console.log("true");
          $(".show-password-generator").addClass('reveal')
          $(".revealButton").text('Conceal');
      } else {
          $(".show-password-generator").removeClass('reveal');
          $(".revealButton").text('Reveal');
          console.log("false")
      }
      meterOnLoad($("span #changeIngPassword").text());
});   

  $(".count-password").load("https://lmptastytrades.com/api/load-password-items-overview.php?email=" + localStorage.getItem("email"));

  $(".userLabel").click(function() {
    $(".active").fadeIn();
  })

  $("#item-details").click(function() {
    $(".active").fadeOut();
    $(".large-type-popup").fadeOut();
  })

  $("#item-list").click(function() {
    $(".active").fadeOut();
  })

  $(document).on('click', '.large-type-show', function() {
    $(".content-box").load("https://lmptastytrades.com/api/large-type-show.php?id="+localStorage.getItem("clickedPasswordId"), function() {
        console.log("done loading")
        setTimeout(function() {
            $("#modal").fadeIn();
        }, 100);
    })
  });

  $("#item-list").on('click', function() {
    $("#modal").fadeOut();
  })
  $("#item-details").on('click', function() {
    $("#modal").fadeOut();
  })
  $("#sidebar").on('click', function() {
    $("#modal").fadeOut();
  })

  $(document).on('click', '.save-new-password', function() {
    var generatedPasswordId = localStorage.getItem("firstname")+"-"+Math.floor((Math.random() * 99999999) + 10000000)+"-1"
    localStorage.removeItem("clickedPasswordId");
    localStorage.setItem("clickedPasswordId", generatedPasswordId);
    if($("#username").val() == ""){
      console.log("Username empty");
    }else if($("#editPassword").val() == ""){
      console.log("Password is empty");
    }else if($("#website").val() == ""){
      console.log("website is empty")
    }else if($("#notes").val() == ""){
      console.log("notes is empty")
    }else if($("#title").val() == ""){
      console.log("Title is empty")
    }else{
      $.ajax({
        url: 'https://lmptastytrades.com/api/save-new-password.php',
        type: 'POST',
        data: {
          email: localStorage.getItem("email"),
          username: $("#username").val(),
          password: $("#editPassword").val(),
          website: $("#website").val(),
          notes: $("#notes").val(),
          passwordId: generatedPasswordId,
          created: $("#datum").text(),
          lastmodified: $("#datum2").text(),
          image: 'https://s2.googleusercontent.com/s2/favicons?domain='+$("#website").val(),
          title: $("#title").val()
      },
      })
      .done(function(respons) {
        console.log("Success: new password saved");
        console.log(respons);
        $("#item-details").removeClass('editing');
        $("#item-details").load("https://lmptastytrades.com/api/load-password-content.php?id="+ generatedPasswordId);
        $("#item-list").load("https://lmptastytrades.com/api/get-password-list.php?email=" + localStorage.getItem("email"), function() {
          console.log("Done loading password list");
        })
      })
      .fail(function(respons) {
        console.log("Error: failed to save new password entry");
        console.log(respons);
      })
      .always(function(){
        
      })
    }
    
  });//end function save new password

  $(document).on('click', '.cancel', function() {
    $("#editUsername").replaceWith("<span id='username'>" + localStorage.getItem("oldUsername") + "</span>")
    $("#editPassword").replaceWith("<span id='password'>" + localStorage.getItem("oldPassword") + "</span>")
    $("#editWebsite").replaceWith("<div class='link value-container' id='websiteHtml'>" + localStorage.getItem("oldWebsite") + "</div>")
    $("#editNotes").replaceWith("<td class='notes'>" + localStorage.getItem("oldNotes") + "</td>")
    $("#editTitle").replaceWith("<h0 id='title'>" + localStorage.getItem("oldTitle") + "</h1>")
    $("#item-details").removeClass('editing ')
    $(".value-container-username").removeAttr('style');
    $(".value-container").removeAttr('style')
    $(".hideButton").show();
    $(".generate-password").hide();
    $(".password-generator").hide();
    localStorage.removeItem("oldUsername");
    localStorage.removeItem("oldPassword");
    localStorage.removeItem("oldWebsite");
    localStorage.removeItem("oldNotes");
    localStorage.removeItem("oldTitle");
    // loadSave(localStorage.getItem("clickedPasswordId"));
  })

  $(document).on('click', '.edit', function(event) {
    localStorage.setItem("oldUsername", $("#username").text());
    localStorage.setItem("oldPassword", $("#password").html());
    localStorage.setItem("oldWebsite", $("#websiteHtml").html());
    localStorage.setItem("oldNotes", $(".notes").text());
    localStorage.setItem("oldTitle", $("#title").text());
    var oldUsernameValue = $("#username").text();
    var oldPasswordValue = $("span #changeIngPassword").text();
    var oldWebsiteValue = $(".domain").text();
    var oldNotesValue = $(".notes").text();
    var oldTitlevalue = $("#title").text();
    event.preventDefault();
    $(".value-container").css('width', '85%');
    $(".value-container-username").css("width", "65%");
    $("#username").replaceWith("<input type='text' name='username' value='" + oldUsernameValue + "' id='editUsername'>");
    $("#password").replaceWith("<input type='text' onkeyup='meter(this.value)' name='password' value='" + oldPasswordValue + "' id='editPassword'>");
    $("#websiteHtml").replaceWith("<input type='text' name='website' value='" + oldWebsiteValue + "' id='editWebsite'>");
    $(".notes").replaceWith("<textarea id='editNotes' placeholder='' style='height: 100px;'>" + oldNotesValue + "</textarea>");
    $("#title").html("<input type='text' placeholder='Title' style='width:80%' id='editTitle' value='" + oldTitlevalue + "'>")
    $(".hideButton").hide();
    $("#item-details").addClass('editing');
    $(".generate-password").show();
  });

  $(document).on('click', '.add', function() {
    $.get("https://lmptastytrades.com/api/new-password-add.php", function(data) {
        $("#item-details").replaceWith(data);
    });
  })


  $(document).on('click', '.save', function() {
    $.ajax({
      url: 'https://lmptastytrades.com/api/save-editted-password.php',
      type: 'POST',
      data: {
        username: $("#editUsername").val(),
        password: $("#editPassword").val(),
        website: $("#editWebsite").val(),
        notes: $("#editNotes").val(),
        title: $("#editTitle").val(),
        passwordId: localStorage.getItem("clickedPasswordId")
      },
      })
      .done(function(respons) {
        console.log(respons)
        loadSave(localStorage.getItem("clickedPasswordId"));
      })
      .fail(function() {
        console.log("error");
      })
      .always(function(respons) {
        console.log("Sending: " + $("#editUsername").val() + " | " + $("#editPassword").val() + " With passwordId : " + localStorage.getItem("clickedPasswordId"));
      });
  })

  $(document).on('click', '#copyPassword', function() {
    var input = $("span #changeIngPassword").text();
    clipboard.writeText(input)
  })

  $(document).on('click', '#copyUsername', function() {
    var input2 = $("#username").text();
    clipboard.writeText(input2)
  })

  $(document).on('click', '.generate-password', function() {
      $(".password-generator").toggle("fast");
      // var passwordLength = $("#length").val();
      // if ($('input#digitsCheckbox').is(':checked')){ 
      //   var digits = "yes"; 
      // }else{
      //   var digits = "no";
      // };
      // var symbols = "no";
      // $("#editPassword").val(makeid(passwordLength, digits, symbols));
  })

  $(document).on('click', '#regenPass', function() {
    var passwordLength = $("#length").val();
    if ($('input#digitsCheckbox').is(':checked')) {
        var digits = "yes";
    } else {
        var digits = "no";
    };

    if ($('input#symbolsCheckbox').is(':checked')) {
        var symbols = "yes";
    } else {
        var symbols = "no";
    };
    $("#editPassword").val(makeid(passwordLength, digits, symbols));
  })

  $(document).on('click', '.password-generator', function() {
    if ($('input#digitsCheckbox').is(':checked')) {
        console.log("checked")
    } else {
        console.log("not checked")
    };
  })

  $(document).on('mouseover', '#trash', function() {
    $("#trash").css('background-color', 'lightgray');
  })

  $(document).on('mouseleave', '#trash', function() {
    $("#trash").css('background-color', '');
  })

  $(document).on('click', '#trash', function() {
    $("#trash").addClass('selected')
    $("#item-list").load("https://lmptastytrades.com/api/trash.php")
  })

  $(document).on('click', '#trash', function() {
    $("#trash").addClass('selected')
    $("#passwordOverzicht").removeClass('selected')
    $("#item-list").load("https://lmptastytrades.com/api/trash.php")
  })

  $("#passwordOverzicht").click(function() {
    $("#passwordOverzicht").addClass('selected');
    $("#trash").removeClass('selected')
    $("#item-list").load("https://lmptastytrades.com/api/get-password-list.php?email=" + localStorage.getItem("email"));
  })
}) // end document ready

    </script>
  </div>
  </body>
</html>